pipeline {
	agent any
	 
   parameters {
    string(name: 'DOCKER_PUSH_USERNAME', defaultValue: 'ramanurs', description: 'Docker group username for pushing images..')
	string(name: 'PROJECT_NAME', defaultValue: 'petclinic1', description: 'project name for creating image..')
	}
	
	stages {
	   stage('checkout'){
		 git 'https://github.com/ramanurs/spring-framework-petclinic.git'
		
		  bat "echo 'build project...'"
			bat 'mvn clean install'
		
	   }
    stage('bake image') {
	   steps{
	    step {
			script {
				pom = readMavenPom file: 'pom.xml'
				//bat "echo Project Version: ${pom.version}"
				IMAGE_NAME = "${params.DOCKER_PUSH_USERNAME}/${params.PROJECT_NAME}:${pom.version}_${env.BUILD_NUMBER}"
			}
			
			bat "echo Project Version1: ${IMAGE_NAME}"
			
		}
	   }
	}
	}
}